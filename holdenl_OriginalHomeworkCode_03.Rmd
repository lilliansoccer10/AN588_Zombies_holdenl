---
title: "Zombies Homework 3"
author: "By: Lillian Holden"
date: "Due October 11th, 2023 for Peer Commentary"
output: html_document
editor_options: 
  chunk_output_type: console
--- 

```{r zombie, echo=FALSE, fig.align='center', fig.cap='Aghhhhhh!', out.width='25%'}
knitr::include_graphics('~/Documents/GitHub/AN588_Zombies_holdenl/zombie.png')
```

```{r}
library(curl)
library(dplyr)
library(sciplot)
library(manipulate)
library(ggplot2)
```

#### I am having issues formatting the knitted file to the specific theme -- any suggestions?

## Challenges
1. I had a very hard time coming up with and keeping track of the variables I was using. This homework had a lot of information, and it got overwhelming at times.
2. I also read that we could not find standard deviation for question 1 using the sd() function, so I did it manually at first - but it got me the same answer. 
3. I had a hard time with my box plots on question 2, but after looking through the modules/googling my issue, I was able to figure it out. 
4. For question 3, I originally thought I needed to put height/weight/age in one plot, so I was having a really hard time. I then realized we probably need one plot showing age vs. weight and one showing age vs. height and had to compare them. 
5. Lastly, I had a hard time with the sample function. I found a function that worked: sample_n.  


```{r}
f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN588_Fall23/zombies.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE) #Assign D as the vector for the data set
head(d)
```

#### Assign Each Varible to a Vector (Excluding D)
```{r} 
a <- d$height
b <- d$weight
c <- d$age
e <- d$zombies_killed
f <- d$years_of_education
```

## Question 1
```{r}
#Finding the Mean
mean(a, na.rm=TRUE)
mean(b, na.rm=TRUE)
mean(c, na.rm=TRUE)
mean(e, na.rm=TRUE)
mean(f, na.rm=TRUE)
```


```{r}
#Finding Standard Deviation Step-By-Step
sqrt(sum((a-mean(a))^2/(length(a)-1)))
sqrt(sum((b-mean(b))^2/(length(b)-1)))
sqrt(sum((c-mean(c))^2/(length(c)-1)))
sqrt(sum((e-mean(e))^2/(length(e)-1)))
sqrt(sum((f-mean(f))^2/(length(f)-1)))
```

```{r}
#Finding the Standard Deviation with sd() Function
sd(d$height, na.rm=TRUE)
sd(d$weight, na.rm=TRUE)
sd(d$age, na.rm=TRUE)
sd(d$zombies_killed, na.rm=TRUE)
sd(d$years_of_education, na.rm=TRUE)
```

## Question 2

```{r}
boxplot(height ~ gender, d, main = "Height in Relation to Gender", xlab = "Gender", ylab = "Height")
```

```{r}
boxplot(weight ~ gender, d, main = "Weight in Relation to Gender", xlab = "Gender", ylab = "Weight")
```

```{r warning=FALSE}
boxplot(age ~ gender, d, main = "Age in Relation to Gender", xlab = "Gender", ylab = "Age")
```

```{r}
boxplot(zombies_killed ~ gender, d, main = "Zombies Killed in Relation to Gender", xlab = "Gender", ylab = "Zombies Killed")
```

```{r}
boxplot(years_of_education ~ gender, d, main = "Years of Education in Relation to Gender", xlab = "Gender", ylab = "Years of Education")
```

## Question 3
```{r}
par(mfrow = c(1, 2))
plot(x = d$age, y = d$height)
plot(x = d$age, y = d$weight)
```

#### Do these variables seem related? In what way?
#### Data seems to collect near the 20s for both weight and height meaning that people in their 20s weight more and are taller than other ages in the data set. The data overall for height seems to increase as age increases, whereas weight follows that trend to an extent, but is more dispersed and ranges throughout age. 

## Question 4

```{r}
hist(a, main = "Histogram of Height", xlim = c(50,90), xlab = "Height", ylab = "Probability")
```

```{r}
qqnorm(a, main = "QQ Plot of Height" )
qqline(a,col="gray")
```

#### Based on the two graphs above, it can be concluded that height originates from a normal distribution. 

```{r}
hist(b, main = "Histogram of Weight", xlim = c(50,250), xlab = "Weight", ylab = "Probability")
```

```{r}
qqnorm(b, main = "QQ Plot of Weight")
qqline(b,col="gray")
```

#### Based on the two graphs above, it can be concluded that weight originates from a normal distribution. 

```{r}
hist(c, main = "Histogram of Age", xlim = c(5,35), xlab = "Age", ylab = "Probability")
```

```{r}
qqnorm(c, main = "QQ Plot of Age" )
qqline(c,col="gray")
```

#### Based on the two graphs above, it can be concluded age originates from a normal distribution. 

```{r}
hist(e, main = "Histogram of Zombies Killed", xlim = c(0,20), xlab = "Zombies Killed", ylab = "Probability")
```

```{r}
qqnorm(e, main = "QQ Plot of Zombies Killed" )
qqline(e,col="gray")
```

#### Based on the two graphs above, it can be concluded that zombies killed does not originate from a normal distribution. 

```{r}
hist(f, main = "Histogram of Years of Education", xlim = c(0,10), xlab = "Years of Education", ylab = "Probability")
```

```{r}
qqnorm(f, main = "QQ Plot of Years of Education" )
qqline(f,col="gray")
```

#### Based on the two graphs above, it can be concluded that years of education does not originate from a normal distribution. 


## Question 5

#### One Subset of 30 Zombies

```{r}
set.seed(1)
zombiesample <- sample_n(d, size = 30, replace = FALSE) 
zombiesample
```

#### One Subset of 30 Zombies Means

```{r}
mh <- mean(zombiesample$height)
mh
mw <- mean(zombiesample$weight)
mw
ma <- mean(zombiesample$age)
ma
mk <- mean(zombiesample$zombies_killed)
mk
me <- mean(zombiesample$years_of_education)
me
```

#### One Subset of 30 Zombies Standard Deviations
```{r}
sd(zombiesample$height)
sd(zombiesample$weight)
sd(zombiesample$age)
sd(zombiesample$zombies_killed)
sd(zombiesample$years_of_education)
```

#### One Subset of 30 Zombies Standard Errors

```{r}
se(zombiesample$height)
se(zombiesample$weight)
se(zombiesample$age)
se(zombiesample$zombies_killed)
se(zombiesample$years_of_education)
```

#### CIs of 1 Subset of 30 Zombies Using a T-Test (I'm not sure if I can use the t.test here, but why not?)

```{r}
t.test(zombiesample$height)
```

```{r}
t.test(zombiesample$weight)
```

```{r}
t.test(zombiesample$age)
```

```{r}
t.test(zombiesample$zombies_killed)
```

```{r}
t.test(zombiesample$years_of_education)
```

## Question 6 

#### 99 Samples of 30 Zombies

```{r}
#I used the replicate function to sample 99 more means of each variable
set.seed(1)
z <- replicate(99, mean(sample(d$height, 30, replace = FALSE)))
y <- replicate(99, mean(sample(d$weight, 30, replace = FALSE)))
x <- replicate(99, mean(sample(d$age, 30, replace = FALSE)))
w <- replicate(99, mean(sample(d$zombies_killed, 30, replace = FALSE)))
v <- replicate(99, mean(sample(d$years_of_education, 30, replace = FALSE)))
```


#### Output the 99 means for each variable 
```{r}
z
y
x
w
v
```

#### Combining Old Sample with New Sample

```{r}
meanheights <- c(mh,z)
meanweights <- c(mw,y)
meanages <- c(ma,x)
meanzombiekills <- c(mk,w)
meanyearsedu <- c(me,v)
```

#### Check to make sure there are 100 means for each variable
```{r}
meanheights
meanweights
meanages
meanzombiekills
meanyearsedu
```

#### Calculating the Final Means and Standard Deviations

```{r}
mean(meanheights)
mean(meanweights)
mean(meanages)
mean(meanzombiekills)
mean(meanyearsedu)
```

```{r}
sd(meanheights)
sd(meanweights)
sd(meanages)
sd(meanzombiekills)
sd(meanyearsedu)
```

vs 

#### Standard Errors from Question 5

[1] 0.6819214
[1] 2.962555
[1] 0.5405065
[1] 0.3067566
[1] 0.3088106


#### The standard deviations in question 6 are similar to the standard errors from question 5. The weights seem to be the most different, however. The differences are listed below: 

```{r}
sd(meanheights)-se(zombiesample$height)
sd(meanweights)-se(zombiesample$weight)
sd(meanages)-se(zombiesample$age)
sd(meanzombiekills)-se(zombiesample$zombies_killed)
sd(meanyearsedu)-se(zombiesample$years_of_education)
```

#### Determining Normal Distribution 
```{r}
hist(meanheights, main = "Histogram of Final Sample Height", xlim = c(65,70), xlab = "Height", ylab = "Probability")
```

#### Based on the graph above, it can be concluded age originates from a normal distribution. 

```{r}
hist(meanweights, main = "Histogram of Final Sample Weight", xlim = c(130,155), xlab = "Weight", ylab = "Probability")
```

#### Based on the graph above, it can be concluded age originates from a normal distribution.

```{r}
hist(meanages, main = "Histogram of Final Sample Ages", xlim = c(18,22), xlab = "Ages", ylab = "Probability")
```

#### Based on the graph above, it can be concluded age originates from a normal distribution.

```{r}
hist(meanzombiekills, main = "Histogram of Final Sample Zombie Kills", xlim = c(2,4.5), xlab = "Zombie Kills", ylab = "Probability")
```

#### Based on the graph above, it can be concluded age originates from a normal distribution.

```{r}
hist(meanyearsedu, main = "Histogram of Final Sample Years of Education", xlim = c(2,4), xlab = "Years of Education", ylab = "Probability")
```

#### Based on the graph above, it can be concluded age originates from a normal distribution.

#### In the previous example: ages, zombies killed, and years of education were all not normal distributions, but now they are. 
